<!DOCTYPE html>
<html>

  <head>
    
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<title>

  DT-tbx website


  | NN for PDEs

</title>
<meta name="description" content="Based on [*folio](https://github.com/bogoli/-folio) design.
">

<!-- Open Graph -->


<!-- Bootstrap & MDB -->
<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet" integrity="sha512-MoRNloxbStBcD8z3M/2BmnT+rg4IsMxPkXaGh2zD6LGNNFE80W3onsAhRcMAMrSoyWL9xD7Ert0men7vR8LUZg==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/css/mdb.min.css" integrity="sha512-RO38pBRxYH3SoOprtPTD86JFOclM51/XTIdEPh5j8sj4tp8jmQIx26twG52UaLi//hQldfrh7e51WzP9wuP32Q==" crossorigin="anonymous" />

<!-- Fonts & Icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css"  integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.0/css/academicons.min.css" integrity="sha512-W4yqoT1+8NLkinBLBZko+dFB2ZbHsYLDdr50VElllRcNt2Q4/GSs6u71UHKxB7S6JEMCp5Ve4xjh3eGQl/HRvg==" crossorigin="anonymous">
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">

<!-- Code Syntax Highlighting -->
<link rel="stylesheet" href="https://combinatronics.io/jwarby/jekyll-pygments-themes/master/.css" />

<!-- Styles -->

<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üë•</text></svg>">

<link rel="stylesheet" href="/DT-tbx-v1/assets/css/main.css">
<link rel="canonical" href="/DT-tbx-v1/blog/2022/nn4pde/">

<!-- JQuery -->
<!-- jQuery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>


<!-- Theming-->

<script src="/DT-tbx-v1/assets/js/theme.js"></script>
<script src="/DT-tbx-v1/assets/js/dark_mode.js"></script>






    
<!-- MathJax -->
<script type="text/javascript">
  window.MathJax = {
    tex: {
      tags: 'ams'
    }
  };
</script>
<script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script>
<script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>


  </head>

  <body class="fixed-top-nav ">

    <!-- Header -->

    <header>

    <!-- Nav Bar -->
    <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
    <div class="container">
      
      <a class="navbar-brand title font-weight-lighter" href="https://markasch.github.io/DT-tbx-v1/">
       DT-tbx website
      </a>
      
      <!-- Navbar Toggle -->
      <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar top-bar"></span>
        <span class="icon-bar middle-bar"></span>
        <span class="icon-bar bottom-bar"></span>
      </button>
      <div class="collapse navbar-collapse text-right" id="navbarNav">
        <ul class="navbar-nav ml-auto flex-nowrap">
          <!-- About -->
          <li class="nav-item ">
            <a class="nav-link" href="/DT-tbx-v1/">
              about
              
            </a>
          </li>
          
          <!-- Blog -->
          <li class="nav-item active">
            <a class="nav-link" href="/DT-tbx-v1/blog/">
              blog
              
            </a>
          </li>
          
          <!-- Other pages -->
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/DT-tbx-v1/codes/">
                codes
                
              </a>
          </li>
          
          
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/DT-tbx-v1/consulting/">
                consulting
                
              </a>
          </li>
          
          
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/DT-tbx-v1/publications/">
                publications
                
              </a>
          </li>
          
          
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/DT-tbx-v1/training/">
                training
                
              </a>
          </li>
          
          
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/DT-tbx-v1/twins/">
                twins
                
              </a>
          </li>
          
          
          
          
            <div class="toggle-container">
              <a id="light-toggle">
                  <i class="fas fa-moon"></i>
                  <i class="fas fa-sun"></i>
              </a>
            </div>
          
        </ul>
      </div>
    </div>
  </nav>

</header>


    <!-- Content -->

    <div class="container mt-5">
      

<div class="post">

  <header class="post-header">
    <h1 class="post-title">NN for PDEs</h1>
    <p class="post-meta">January 8, 2022</p>
  </header>

  <article class="post-content">
    <p>In a recent <a href="/DT-tbx-v1/assets/pdf/Asch_NN_4_IP.pdf">talk</a> I attempted to review the state-of-the-art in the use of neural networks for solving direct and inverse problems based on PDEs. This topic is treated in Chapter 13 of the <a href="link???">book</a>, but is evolving at lightning speed, so I will need to update this post regularly.</p>

<p>As always, my objective is to see how these approaches can be used in concrete digital twins. The potential is, IMHO, enormous. They represent, in theory and in practice, an ideal coupling of data-driven and model-based methods. Please consult the <a href="/DT-tbx-v1/blog/2021/ai4sci/">post</a> on AI for Science, for a more general viewpoint.</p>

<hr>

<p>The theoretical foundations for the approaches are strong:</p>

<ol>
  <li>The universal approximation property.</li>
  <li>The ‚Äúunreasonable‚Äù efficiency of automatic differetntiation.</li>
</ol>
<hr>

<p>We will come back to these two, after formulating the problem.</p>

<p>Recall that for Digital Twins, in essence, we want to model a mapping \(f\) between input variables (design parameters), \(\theta,\) and output data (observations, measurements, simulation results), \(y,\)</p>

\[y = f(x; \theta),\]

<p>where \(x\) represents the independent variable (space, time). For given \(\theta,\) (and \(f\)) this is the <strong>direct</strong> problem. If we know \(y\) and we seek \(\theta,\) then we need to solve an <strong>inverse</strong> problem. In real contexts, there will be an additional term \(\xi(x,t)\) to model the noise, or uncertainty,</p>

\[y = f(x; \theta)  + \xi .\]

<p>Solving the direct and inverse problems can be difficult, time-consuming, unreliable, in particular in the presence of noise, which is always present, though rarely taken into account. The inverse problems are notoriously complicated and for concrete problems, impossible to solve in reasonable time and with reasonable accuracy, unless one disposes of immense computational power, eg. for daily weather forecasting.</p>

<p>So, the challenge is: if we have (a lot of) measurements, and if we have reliable models, can we combine the two, using machine learning to go beyond what each one, separately, can achieve? Let me reassure you, the answer is ‚ÄúYes, but‚Ä¶‚Äù, since the recent advances are impressive, though there is ‚Äúno free lunch‚Äù. Meaning, one has to work on one‚Äôs particular context, process, problem in order to obtain the promised/desired improvements.</p>

<p>Let us now return to the two foundations.</p>

<p>The first foundation justifies the use of <strong>simple</strong> neural networks for the approximation of a complex, nonlinear map bteween inputs and outputs. There are solid theorems that guarantee the convergence of NNs to virtually any complex functional relationship. We can then build machine leanring models based directly on these theorems, just as we have always done for model-based approximations and their computational modeling.</p>

<p>The second foundation provides the means to ensure that the data-driven model also respects the underlying physics/chemistry/biology/etc. This is essential if we are to base decision-making on the outcomes of our DTs. Theoretically, this respect of the ‚Äúphysics‚Äù is extremely simple to implement. Let us now explain this simplicity.</p>

<p>Suppose that the ML model mimimizes a loss function \(\mathcal{L}_M(w),\) where \(w\) are the parameters‚Äîweights and biases‚Äîof the neural network. Now, just add terms to the loss function that enforce the respect of the PDE and its initial/boundary conditions. That is, we seek to minimize the composite loss function</p>

\[\mathcal{L}_M(w,\theta) = \mathcal{L}_M(w) + \mathcal{L}_P(\theta),\]

<p>where \(\theta\) are the coefficients of the PDE. This formulation is then valid for</p>

<ul>
  <li>the direct problem, and</li>
  <li>the inverse problem.</li>
</ul>

<p>The actual formulation of \(\mathcal{L}_P(\theta)\) is obtained using AD (automatic differentiation), just as used in the stochastic gradient minimization algorithm for finding the best NN coefficients. It‚Äôs as ‚Äúeasy‚Äù as that!  Ok, ‚Äúeasy‚Äù is in quotes, since we obtain a horrible optimization problem that usually requires some intense hyperparameter tuning, or ensembles of initializations, to converge reasonably well. But when it does, we are then in the SUMO position‚Äîsee this <a href="/DT-tbx-v1/blog/2022/SUMO/">blog</a> post‚Äîwhere once we have completed the expensive, offline learning stage, we have an inference tool that can provide speedups of \(10^3\) or \(10^4.\) This is not a 2X or 3X speedup, but literally three to four orders of magnitude! For example, a 10 hour computation can be performed in \(0.01\) hours, or \(100\) such computations can be performed in one hour.</p>

<p>For all the details and numerous examples, the following references are recommended.</p>

<ol>
  <li>Lu, Karniadakis. <a href="https://epubs.siam.org/doi/abs/10.1137/19M1274067" target="_blank" rel="noopener noreferrer">SIAM Review</a>, 2021.</li>
  <li>Wang, Wang, Bhouri, Perdikaris. <a href="https://arxiv.org/abs/2103.10974v1" target="_blank" rel="noopener noreferrer">arXiv:2103.10974v1</a>, <a href="https://arxiv.org/abs/2106.05384" target="_blank" rel="noopener noreferrer">arXiv:2106.05384</a>, <a href="https://arxiv.org/abs/2110.01654" target="_blank" rel="noopener noreferrer">arXiv:2110.01654</a>, <a href="https://arxiv.org/abs/2110.13297" target="_blank" rel="noopener noreferrer">arXiv:2110.13297</a>
</li>
  <li>Mishra, Molinaro. <a href="https://arxiv.org/abs/2006.16144v2" target="_blank" rel="noopener noreferrer">arXiv:2006.16144v2</a>
</li>
  <li>Battacharya, Hosseini, Kovachki, Stuart. <a href="https://arxiv.org/abs/2005.03180" target="_blank" rel="noopener noreferrer">arXiv:2005.03180</a>
</li>
  <li>Lu, Meng, Cai, Mai, Goswami, Zhang, Karniadakis. <a href="https://arxiv.org/abs/2111.05512" target="_blank" rel="noopener noreferrer">arXiv:2111.05512</a>
</li>
</ol>

<p>My <a href="/DT-tbx-v1/assets/pdf/Asch_NN_4_IP.pdf">talk</a> is a personal summary of the above references, in order to apply the approach to a digital twin of a  <a href="https://youtu.be/Kn_-xLzz5pg" target="_blank" rel="noopener noreferrer">sperm-whale</a> that we are developing in the framework of the national AI chair <a href="https://bioacoustics.lis-lab.fr/" target="_blank" rel="noopener noreferrer">ADSIL</a>. In the <a href="/DT-tbx-v1/twins/">twins</a> section, there is a description of the whale‚Äôs <a href="/DT-tbx-v1/projects/whales/">digital twin</a>.</p>


  </article>

  

</div>

    </div>

    <!-- Footer -->

    
<footer class="fixed-bottom">
  <div class="container mt-0">
    ¬© Copyright 2024 Mark A. Asch.
    Powered by <a href="http://jekyllrb.com/" target="_blank" rel="noopener noreferrer">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" target="_blank" rel="noopener noreferrer">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="noopener noreferrer">GitHub Pages</a>.

    
    
  </div>
</footer>



  </body>

  <!-- Bootsrap & MDB scripts -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.4.4/umd/popper.min.js" integrity="sha512-eUQ9hGdLjBjY3F41CScH3UX+4JDSI9zXeroz7hJ+RteoCaY+GP/LDoM8AO+Pt+DRFw3nXqsjh9Zsts8hnYv8/A==" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha512-M5KW3ztuIICmVIhjSqXe01oV2bpe248gOxqmlcYrEzAvws7Pw3z6BK0iGbrwvdrUQUhi3eXgtxp5I8PDo9YfjQ==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/js/mdb.min.js" integrity="sha512-Mug9KHKmroQFMLm93zGrjhibM2z2Obg9l6qFG2qKjXEXkMp/VDkI4uju9m4QKPjWSwQ6O2qzZEnJDEeCw0Blcw==" crossorigin="anonymous"></script>

  
<!-- Mansory & imagesLoaded -->
<script defer src="https://unpkg.com/masonry-layout@4/dist/masonry.pkgd.min.js"></script>
<script defer src="https://unpkg.com/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
<script defer src="/DT-tbx-v1/assets/js/mansory.js" type="text/javascript"></script>


  


<!-- Medium Zoom JS -->
<script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script>
<script src="/DT-tbx-v1/assets/js/zoom.js"></script>


<!-- Load Common JS -->
<script src="/DT-tbx-v1/assets/js/common.js"></script>


</html>
